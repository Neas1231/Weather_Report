# *Weather Report*
Классификатор изображений погодных условий
## Пример работы веб приложения:
![Weather report (1)](https://user-images.githubusercontent.com/120177610/236161416-a881eec7-d87e-4b24-98e0-99e18eb04d52.gif)
## Описание структуры репозитория
1. __Папка notebooks__ <br />
- __Train models__ - код обучения моделей классификации погоды <br/>

> В ходе заполнения папки было проведена работа по подбору гиперпараметров, предобученных моделей и остальных не мало важных конфигураций. Самая лучшая модель была подобрана по наилучшему параметру loss из всех обученных эпох и по матрице метрик, выведенной в файле Models_test.ipynb <br />
- __EDA.ipynb__ - анализ собранного из сети датасета, дополненного классом "No weather" <br />
- __Models_test.ipynb__ - выведение метрик по каждому классу обученной модели с помощью отложенной выборки
- __Inference.ipynb__ - пример работы обученной модели по распознаванию погоды на фото с графическим выводом
2. __Папка download__ <br />

> Представляет собой веб приложение основанное на библиотеке streamlit для развёртывания обученной модели <br />
- __requirements.txt__ - требуемые библиотеки для работы проекта
- __style.css__ - настройки стиля сайта, дополнение визуала интерфейса <br />
- __weather.py__ - основной код веб приложения развёртывания получившейся модели <br />
- __weights-no_weather_class-efinetb4-bestloss.pth__ - веса для модели, которые были полученны при обучении и валидации множества различных предобученных классификаторов <br />
3. __Файл Readme.md__ <br />
__Текстовый документ содержащий информацию о репозитории__
## Инструкция для установки веб приложения на свой компьютер.
1. Скачайте любую версию python <br />

> В ходе установки python укажите галочку на против Add python.exe to PATH и проверить сработала ли установка в cmd командой 'python --version'

> Если вы пропустили этот этап, проделайте следующие действия: 

2. Найдите путь к файлу pythonw.exe в файлах python, открывающуюся через ярлык IDLE. <br />
Это путь: C:\Users\\[Пользователь]\AppData\Local\Programs\Python\Python39 <br />
3. В настройках находим раздел Система и в нём находим вкладку Дополнительные параметры системы <br />
4. В параметрах во вкладке дополнительно открываем Переменные среды <br />
5. Ищем Системные переменные и открываем переменную Path двойным кликом <br />
6. Нажимаем кнопку Создать и создаём переменную с путём к pythonw, который мы нашли в предыдущих пунктах. <br />
7. Везде нажимаем ОК и открываем cmd <br />
8. Прописываем команду 'python --version' и если строка вывела версию установленного интерпретатора всё было проделано правильно и cmd готова к установке библиотек

### Установка библиотек
Далее открыв cmd заново впишите по очереди следующие строки для установки библиотек: <br />

py -m pip install streamlit <br />
py -m pip install pandas <br />
py -m pip install Pillow <br />
py -m pip install streamlit-on-Hover-tabs <br />
py -m pip install torch <br />
py -m pip install torchvision <br />
py -m pip install PyDrive <br />

### Установка API и модели

- Скачайте github репозиторий
- Откройте папку download и запустите streamlit сервер
> py -m streamlit run weather.py
